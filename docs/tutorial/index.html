<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Step-by-Step Tutorial · reSolve</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;This document provides a step-by-step tutorial for the reSolve framework.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Step-by-Step Tutorial · reSolve"/><meta property="og:type" content="website"/><meta property="og:url" content="https://reimagined.github.io/resolve/index.html"/><meta property="og:description" content="&lt;p&gt;This document provides a step-by-step tutorial for the reSolve framework.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/resolve/undefined"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://reimagined.github.io/resolve/blog/atom.xml" title="reSolve Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://reimagined.github.io/resolve/blog/feed.xml" title="reSolve Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/resolve/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/resolve/"><img class="logo" src="/resolve/img/resolve.svg" alt="reSolve"/><h2 class="headerTitleWithLogo">reSolve</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/resolve/blog/" target="_self">Blog</a></li><li class="siteNavGroupActive"><a href="/resolve/docs/" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/resolve/docs/faq" target="_self">FAQ</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/reimagined/resolve" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Docs Index</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Docs Index</h3><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/">reSolve Documentation</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/introduction">Introduction</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/resolve/docs/tutorial">Step-by-Step Tutorial</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Basics</h4><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/app-structure">reSolve App Structure</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/write-side">Write Side</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/read-side">Read Side</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/frontend">Frontend</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/curl">Standard HTTP API</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Guides</h4><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/advanced-techniques">Advanced Techniques</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/api-handlers">API Handlers</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/authentication-and-authorization">Authentication and Authorization</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/preparing-to-production">Preparing to Production</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/api-reference">API Reference</a></li><li class="navListItem"><a class="navItem" href="/resolve/docs/contributing">Contributing</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">FAQ</h3><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/faq">FAQ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul><li class="navListItem"><a class="navItem" href="/resolve/docs/troubleshooting">Troubleshooting</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Step-by-Step Tutorial</h1></header><article><div><span><p>This document provides a step-by-step tutorial for the reSolve framework.
Throughout this tutorial, you will be creating a single application. You will modify your application as you learn new concepts, so with every consequent lesson the application will become more and more sophisticated.</p>
<p>This tutorial will give an understanding of the reSolve framework and its fundamental concepts. It is recommended that your familiarize yourself with event sourcing and CQRS before starting this tutorial, however it is not strictly required.</p>
<h2><a class="anchor" aria-hidden="true" id="table-of-contents"></a><a href="#table-of-contents" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2>
<ul>
<li><a href="#lesson-1-create-a-new-resolve-application">Lesson 1 - Create a New reSolve Application</a></li>
<li><a href="#lesson-2-write-side-add-a-list-item">Lesson 2 - Write side - Add a List Item</a></li>
<li><a href="#lesson-3-read-side-create-a-view-model-to-query-list-items">Lesson 3 - Read side - Create a View Model to Query List Items</a></li>
<li><a href="#lesson-4-frontend-display-view-model-data-in-the-browser">Lesson 4 - Frontend - Display View Model Data in the Browser</a></li>
<li><a href="#lesson-5-frontend-enable-data-editing">Lesson 5 - Frontend - Enable Data Editing</a></li>
<li><a href="#lesson-6-frontend-support-multiple-shopping-lists">Lesson 6 - Frontend - Support Multiple Shopping Lists</a></li>
<li><a href="#lesson-7-functionality-enhancements">Lesson 7 - Functionality Enhancements</a></li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-1-create-a-new-resolve-application"></a><a href="#lesson-1-create-a-new-resolve-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 1</strong> - Create a New reSolve Application</h2>
<p>You can create a new reSolve app using the create-resolve-app utility available on <strong>npm</strong>:</p>
<h5><a class="anchor" aria-hidden="true" id="npm"></a><a href="#npm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>npm:</h5>
<pre><code class="hljs css language-sh">npm i -g create-resolve-app
create-resolve-app shopping-list
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="npx"></a><a href="#npx" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>npx:</h5>
<pre><code class="hljs css language-sh">$ npx create-resolve-app shopping-list
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="yarn"></a><a href="#yarn" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>yarn:</h5>
<pre><code class="hljs css language-sh">$ yarn create resolve-app shopping-list
</code></pre>
<p>After this a minimal reSolve application is ready. You can run it in development mode by typing:</p>
<pre><code class="hljs css language-sh">$ yarn run dev
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-2-write-side-add-a-list-item"></a><a href="#lesson-2-write-side-add-a-list-item" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 2</strong> - Write side - Add a List Item</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-2">[Get the Code for This Lesson]</a></p>
<p>This lesson will teach you how to implement a basic write side for your reSolve application. An application's <a href="/resolve/docs/app-structure#write-and-read-sides">write side</a> is responsible for handling commands, performing input validation and emitting <strong>events</strong> based on valid commands. The emitted events are then saved to the <strong>event store</strong>.</p>
<p>In CQRS and Event Sourcing paradigms, commands are handled by Domain Objects, which are grouped into aggregates. ReSolve implements aggregates as static objects containing sets of functions. These functions can of one of the following two kinds:</p>
<ul>
<li><strong><a href="/resolve/docs/write-side#aggregate-command-handlers">Command Handlers</a></strong> - Handle commands and emit events in response.</li>
<li><strong><a href="/resolve/docs/write-side#aggregate-projection-function">Projections</a></strong> - Build aggregate state from events so this state can be observed on the write side, for example to perform input validation.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="creating-an-aggregate"></a><a href="#creating-an-aggregate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating an Aggregate</h3>
<p>Use the following steps to implement the write side for your shopping list application.</p>
<p>To add an aggregate to you shopping list application, first define types of events that this aggregate will produce. Create an <strong>eventTypes.js</strong> file in the project's <strong>common</strong> folder and add the following content to it.</p>
<p><strong>common/eventTypes.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_LIST_CREATED = <span class="hljs-string">"SHOPPING_LIST_CREATED"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_CREATED = <span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>;
</code></pre>
<!-- prettier-ignore-end -->
<p>For now, your application requires only two types of events:</p>
<ul>
<li>The SHOPPING_LIST_CREATED event signals about creation of a shopping list.</li>
<li>The SHOPPING_ITEM_CREATED event signals about creation of an item within a shopping list.</li>
</ul>
<p>Next, create a <strong>shopping_list.commands.js</strong> file in the <strong>common/aggregates</strong> folder. This file will contain command handlers for the ShoppingList aggregate. Add the following code to the file:</p>
<p><strong>common/aggregates/shopping_list.commands.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED, SHOPPING_ITEM_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">createShoppingList</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_LIST_CREATED,
      <span class="hljs-attr">payload</span>: { name }
    }
  },
  <span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_ITEM_CREATED,
      <span class="hljs-attr">payload</span>: { id, text }
    }
  }
}
</code></pre>
<p>As you can see, the file exports an object containing two command handlers. A command handler receives the aggregate state and a commands payload. A payload can contain any arbitrary data related to the command. For example, the <strong>createShoppingList</strong> command's payload contains a shopping list name, and the <strong>createShoppingItem</strong> command payload contains an item's ID and displayed text.</p>
<p>As the result of its execution, a command handler returns an event object. This object contains an obligatory <strong>type</strong> field defining the event's type and the <strong>payload</strong> field containing data associated with the event. In the example code, the event payloads contain the same field that were obtained from the command payloads. The reSolve framework saves events returned by command handlers to a persistent <strong><a href="/resolve/docs/write-side#event-store">event store</a></strong>. For now, your application is configured to use a file-based event store, which is sufficient for learning purposes. Later on, you will learn how to use different kinds of stores using <strong><a href="/resolve/docs/advanced-techniques#adapters">storage adapters</a></strong>.</p>
<p>Your minimal shopping list aggregate is now ready. The last step is to register it in the application's configuration file. Open the <strong>config.app.js</strong> file, locate the <strong>aggregates</strong> section and specify the following settings:</p>
<p><strong>config.app.js:</strong></p>
<pre><code class="hljs css language-js">...
aggregates: [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">commands</span>: <span class="hljs-string">'common/aggregates/shopping_list.commands.js'</span>,
  }
],
...
</code></pre>
<p>Here, you just specify the aggregate name and the path to the file containing the aggregate's command handlers.</p>
<h3><a class="anchor" aria-hidden="true" id="sending-commands-to-an-aggregate"></a><a href="#sending-commands-to-an-aggregate" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending Commands to an Aggregate</h3>
<p>Now that your application is capable of handling commands, you can try sending such commands to create a shopping list and populate it with items.</p>
<p>ReSolve framework provides a standard API that allows you to send commands to an application's aggregate using HTTP requests.</p>
<p>The request body should have the <code>application/json</code> content type and contain a JSON representation of the command:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"aggregateName"</span>: <span class="hljs-string">"ShoppingList"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"createShoppingList"</span>,
  <span class="hljs-attr">"aggregateId"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-attr">"payload"</span>: {
    <span class="hljs-attr">"text"</span>: <span class="hljs-string">"Item 1"</span>
  }
}
</code></pre>
<p>In addition to the aggregate name, command type and payload, this object specifies the aggregate Id (a unique identifier of an aggregate instance).</p>
<p>Run your application and send a POST request to the following URL:</p>
<pre><code class="hljs">http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">3000</span><span class="hljs-regexp">/api/</span>commands
</code></pre>
<p>You can do this using any REST client or using <strong>curl</strong>. For example, use the following inputs to create a shopping list:</p>
<pre><code class="hljs css language-sh">$ curl -i http://localhost:3000/api/commands/ \
--header <span class="hljs-string">"Content-Type: application/json"</span> \
--data <span class="hljs-string">'
{
    "aggregateName": "ShoppingList",
    "aggregateId": "shopping-list-1",
    "type": "createShoppingList",
    "payload": {
        "name": "List 1"
    }
}
'</span>

X-Powered-By: Express
Content-Type: text/plain; charset=utf-8
Date: Wed, 19 Dec 2018 12:16:56 GMT
Connection: keep-alive
Content-Length: 139

{<span class="hljs-string">"type"</span>:<span class="hljs-string">"SHOPPING_LIST_CREATED"</span>,<span class="hljs-string">"payload"</span>:{<span class="hljs-string">"name"</span>:<span class="hljs-string">"List 1"</span>},<span class="hljs-string">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-string">"aggregateVersion"</span>:1,<span class="hljs-string">"timestamp"</span>:1545221816663}

</code></pre>
<p>Use the inputs shown below to add an item to the created shopping list:</p>
<pre><code class="hljs css language-sh">curl -i http://localhost:3000/api/commands/ \
--header <span class="hljs-string">"Content-Type: application/json"</span> \
--data <span class="hljs-string">'
{
    "aggregateName": "ShoppingList",
    "aggregateId": "shopping-list-1",
    "type": "createShoppingItem",
    "payload": {
        "id": "1",
        "text": "Milk"
    }
}
'</span>

X-Powered-By: Express
Content-Type: text/plain; charset=utf-8
Date: Wed, 19 Dec 2018 12:17:53 GMT
Connection: keep-alive
Content-Length: 146

{<span class="hljs-string">"type"</span>:<span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,<span class="hljs-string">"payload"</span>:{<span class="hljs-string">"id"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-string">"text"</span>:<span class="hljs-string">"Milk"</span>},<span class="hljs-string">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-string">"aggregateVersion"</span>:2,<span class="hljs-string">"timestamp"</span>:1545221873644}

</code></pre>
<p>Add several more items to have data to work with in future lessons.</p>
<p>Now, you can check the event store file to see the newly created event. Open the <strong>event-storage.db</strong> file and locate the created event objects:</p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-json">{<span class="hljs-attr">"type"</span>:<span class="hljs-string">"SHOPPING_LIST_CREATED"</span>,<span class="hljs-attr">"payload"</span>:{<span class="hljs-attr">"name"</span>:<span class="hljs-string">"List 1"</span>},<span class="hljs-attr">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-attr">"aggregateVersion"</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">"timestamp"</span>:<span class="hljs-number">1542884752421</span>,<span class="hljs-attr">"aggregateIdAndVersion"</span>:<span class="hljs-string">"shopping-list-1:1"</span>,<span class="hljs-attr">"_id"</span>:<span class="hljs-string">"Ujiz4pjVwid1AaZP"</span>}
{<span class="hljs-attr">"type"</span>:<span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,<span class="hljs-attr">"payload"</span>:{<span class="hljs-attr">"id"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"text"</span>:<span class="hljs-string">"Milk"</span>},<span class="hljs-attr">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-attr">"aggregateVersion"</span>:<span class="hljs-number">2</span>,<span class="hljs-attr">"timestamp"</span>:<span class="hljs-number">1542884835201</span>,<span class="hljs-attr">"aggregateIdAndVersion"</span>:<span class="hljs-string">"shopping-list-1:2"</span>,<span class="hljs-attr">"_id"</span>:<span class="hljs-string">"RBr1596unUVhTJeo"</span>}
{<span class="hljs-attr">"type"</span>:<span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,<span class="hljs-attr">"payload"</span>:{<span class="hljs-attr">"id"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"text"</span>:<span class="hljs-string">"Eggs"</span>},<span class="hljs-attr">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-attr">"aggregateVersion"</span>:<span class="hljs-number">3</span>,<span class="hljs-attr">"timestamp"</span>:<span class="hljs-number">1542884852629</span>,<span class="hljs-attr">"aggregateIdAndVersion"</span>:<span class="hljs-string">"shopping-list-1:3"</span>,<span class="hljs-attr">"_id"</span>:<span class="hljs-string">"WJfG65khmyoPY12U"</span>}
{<span class="hljs-attr">"type"</span>:<span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,<span class="hljs-attr">"payload"</span>:{<span class="hljs-attr">"id"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"text"</span>:<span class="hljs-string">"Canned beans"</span>},<span class="hljs-attr">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-attr">"aggregateVersion"</span>:<span class="hljs-number">4</span>,<span class="hljs-attr">"timestamp"</span>:<span class="hljs-number">1542884875144</span>,<span class="hljs-attr">"aggregateIdAndVersion"</span>:<span class="hljs-string">"shopping-list-1:4"</span>,<span class="hljs-attr">"_id"</span>:<span class="hljs-string">"qvKCvnEOhVQrD7xJ"</span>}
{<span class="hljs-attr">"type"</span>:<span class="hljs-string">"SHOPPING_ITEM_CREATED"</span>,<span class="hljs-attr">"payload"</span>:{<span class="hljs-attr">"id"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"text"</span>:<span class="hljs-string">"Paper towels"</span>},<span class="hljs-attr">"aggregateId"</span>:<span class="hljs-string">"shopping-list-1"</span>,<span class="hljs-attr">"aggregateVersion"</span>:<span class="hljs-number">5</span>,<span class="hljs-attr">"timestamp"</span>:<span class="hljs-number">1542884890484</span>,<span class="hljs-attr">"aggregateIdAndVersion"</span>:<span class="hljs-string">"shopping-list-1:5"</span>,<span class="hljs-attr">"_id"</span>:<span class="hljs-string">"YEnzkAlBjEqaLwQI"</span>}

</code></pre>
<!-- prettier-ignore-end -->
<h3><a class="anchor" aria-hidden="true" id="performing-validation"></a><a href="#performing-validation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Performing Validation</h3>
<p>Your application's write side currently does not perform any input validation. This results in the following flaws:</p>
<ul>
<li>The aggregate allows you to create shopping lists and items without specifying the required fields in the payload.</li>
<li>It is possible to create more then one shopping list with the same aggregate ID.</li>
<li>You can create items for a shopping list that does not exist.</li>
</ul>
<p>You can overcome the first flaw by adding simple checks to each command handler:</p>
<p><strong>common/aggregates/shopping_list.commands.js:</strong></p>
<pre><code class="hljs css language-js">createShoppingList: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!name) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"name is required"</span>);
  ...
},
<span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!id) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'id is required'</span>)
  <span class="hljs-keyword">if</span> (!text) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'text is required'</span>)
  ...
}
</code></pre>
<p>To overcome the second and third flaws, you need to somehow store information about previously performed operations. You can achieve this by maintaining an <strong>aggregate state</strong>. This state is assembled on the fly by an aggregate <strong>projection</strong> from previously created events. To add a projection to the ShoppingList aggregate, create a <strong>shopping_list.projection.js</strong> file in the <strong>common/aggregates</strong> folder and add the following code there:</p>
<p><strong>common/aggregates/shopping_list.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">"../eventTypes"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">Init</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({}),
  [SHOPPING_LIST_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { timestamp }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">createdAt</span>: timestamp
  })
};
</code></pre>
<!-- prettier-ignore-end -->
<p>Register the create projection in the application configuration file:</p>
<p><strong>config.app.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">  aggregates: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"ShoppingList"</span>,
      <span class="hljs-attr">commands</span>: <span class="hljs-string">"common/aggregates/shopping_list.commands.js"</span>,
      <span class="hljs-attr">projection</span>: <span class="hljs-string">"common/aggregates/shopping_list.projection.js"</span>
    }
  ],
</code></pre>
<!-- prettier-ignore-end -->
<p>The projection object should specify an obligatory <strong>Init</strong> function and a set of <strong>projection functions</strong>.</p>
<ul>
<li>The Init function initializes the aggregate state. In the example code, it creates a new empty object.</li>
<li>Projection functions build the aggregate state based on the aggregate's events. Each such function is associated with a particular event type. The function receives the previous state and an event, and returns a new state based on the input.</li>
</ul>
<p>In the example code, the SHOPPING_LIST_CREATED projection function adds the SHOPPING_LIST_CREATED event's timestamp to the state. This information can be used on the write side to find out whether and when a shopping list has been created for the current aggregate instance (i.e., an instance identified by the current aggregate ID).</p>
<p><strong>common/aggregates/shopping_list.commands.js:</strong></p>
<pre><code class="hljs css language-js">  createShoppingList: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.createdAt) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"shopping List already exists"</span>);
    ...
  },
  <span class="hljs-attr">createShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!state || !state.createdAt) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`shopping list does not exist`</span>);
    }
    ...
  }
</code></pre>
<p>You can check whether or not the validation works as intended by sending commands to your aggregate:</p>
<pre><code class="hljs css language-sh"><span class="hljs-comment"># Trying to create a shopping list without specifying the name</span>
$ curl -i http://localhost:3000/api/commands/ \
&gt; --header <span class="hljs-string">"Content-Type: application/json"</span> \
&gt; --data <span class="hljs-string">'
&gt; {
&gt;     "aggregateName": "ShoppingList",
&gt;     "aggregateId": "shopping-list-2",
&gt;     "type": "createShoppingList",
&gt;     "payload": { }
&gt; }
&gt; '</span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   164  100    31  100   133    142    610 --:--:-- --:--:-- --:--:--   655HTTP/1.1 500 Internal Server Error
X-Powered-By: Express
Date: Thu, 22 Nov 2018 11:14:10 GMT
Connection: keep-alive
Content-Length: 31

Command error: name is required


<span class="hljs-comment"># Trying to create a shopping list that already exists</span>
$ curl -i http://localhost:3000/api/commands/ \
&gt; --header <span class="hljs-string">"Content-Type: application/json"</span> \
&gt; --data <span class="hljs-string">'
&gt; {
&gt;     "aggregateName": "ShoppingList",
&gt;     "aggregateId": "shopping-list-1",
&gt;     "type": "createShoppingList",
&gt;     "payload": {
&gt;         "name": "List 1"
&gt;     }
&gt; }
&gt; '</span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   205  100    43  100   162    196    739 --:--:-- --:--:-- --:--:--   798HTTP/1.1 500 Internal Server Error
X-Powered-By: Express
Date: Thu, 22 Nov 2018 11:11:18 GMT
Connection: keep-alive
Content-Length: 43

Command error: shopping list already exists


<span class="hljs-comment"># Trying to add an item to an inexistent shopping list</span>
$ curl -i http://localhost:3000/api/commands/ \
&gt; --header <span class="hljs-string">"Content-Type: application/json"</span> \
&gt; --data <span class="hljs-string">'
&gt; {
&gt;     "aggregateName": "ShoppingList",
&gt;     "aggregateId": "shopping-list-4000",
&gt;     "type": "createShoppingItem",
&gt;     "payload": {
&gt;         "id": "5",
&gt;         "text": "Bread"
&gt;     }
&gt; }
&gt; '</span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   226  100    43  100   183    211    901 --:--:-- --:--:-- --:--:--   901HTTP/1.1 500 Internal Server Error
X-Powered-By: Express
Date: Thu, 22 Nov 2018 11:16:56 GMT
Connection: keep-alive
Content-Length: 43

Command error: shopping list does not exist
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-3-read-side-create-a-view-model-to-query-list-items"></a><a href="#lesson-3-read-side-create-a-view-model-to-query-list-items" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 3</strong> - Read side - Create a View Model to Query List Items</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-3">[Get the Code for This Lesson]</a></p>
<p>Currently, your shopping list application has a fully functional write side allowing you to create shopping lists and items in these lists. However, it does not provide means to query the created data. This lesson will teach you how to provide your application with the capability to answer data queries by implementing the application's <strong><a href="/resolve/docs/app-structure#write-and-read-sides">read side</a></strong>.</p>
<h3><a class="anchor" aria-hidden="true" id="implement-a-view-model"></a><a href="#implement-a-view-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement a View Model</h3>
<p>A reSolve applications read side answers queries using <strong><a href="/resolve/docs/read-side#read-models">Read Models</a></strong>. In this lesson, you will implement a <strong><a href="/resolve/docs/read-side#view-model-specifics">View Model</a></strong>, which is a Read Model of a special kind used to build an application's state on the fly, so you can keep the implementation simple. In a <a href="#implement-a-shopping-lists-read-model">later lesson</a>, you will learn how to use regular Read Models to answer queries based on accumulated persistent state.</p>
<p>Create a <strong>shopping_list.projection.js</strong> file in the <strong>view-models</strong> folder and add the following code to this file:</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED, SHOPPING_ITEM_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">"../eventTypes"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">Init</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-literal">null</span>,
  [SHOPPING_LIST_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { aggregateId, payload: { name } }</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: aggregateId,
    name,
    <span class="hljs-attr">list</span>: []
  }),
  [SHOPPING_ITEM_CREATED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id, text } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">list</span>: [
      ...state.list,
      {
        id,
        text,
        <span class="hljs-attr">checked</span>: <span class="hljs-literal">false</span>
      }
    ]
  })
};
</code></pre>
<!-- prettier-ignore-end -->
<p>You just defined a View Model <strong><a href="/resolve/docs/read-side#updating-a-read-model-via-projection-functions">projection</a></strong>. A View Model projection runs for all events for a specific aggregate ID. Based on event data, a projection builds state. This state is then returned as a query response.</p>
<p>Now, you need to register the implemented View Model in the application's configuration file.</p>
<p><strong>config.app.js:</strong></p>
<pre><code class="hljs css language-js">...
viewModels: [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">projection</span>: <span class="hljs-string">'common/view-models/shopping_list.projection.js'</span>
  }
],
...
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="query-a-view-model-via-http-api"></a><a href="#query-a-view-model-via-http-api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query a View Model via HTTP API</h3>
<p>Now you can tests the read side's functionality by sending an HTTP request to query the Shopping List View Model. You can query a View Model by sending an HTTP request to your application as shown below:</p>
<pre><code class="hljs css language-sh">$  curl -i -g -X GET <span class="hljs-string">"http://localhost:3000/api/query/ShoppingList/shopping-list-1"</span>
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 50
ETag: W/<span class="hljs-string">"32-QoPdRfMTxfncCZnYSqRYIDifC/w"</span>
Date: Fri, 16 Nov 2018 12:10:58 GMT
Connection: keep-alive

{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>,
  <span class="hljs-string">"list"</span>: [
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"1"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Milk"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"2"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Eggs"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"3"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Canned beans"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"4"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Paper towels"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    }
  ]
}
</code></pre>
<p>The request URL has the following structure:</p>
<pre><code class="hljs"><span class="xml">http://</span><span class="hljs-template-variable">{host}</span><span class="xml">:</span><span class="hljs-template-variable">{port}</span><span class="xml">/api/query/</span><span class="hljs-template-variable">{viewModel}</span><span class="xml">/</span><span class="hljs-template-variable">{aggregateIds}</span><span class="xml">
</span></code></pre>
<h5><a class="anchor" aria-hidden="true" id="url-parameters"></a><a href="#url-parameters" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>URL Parameters</h5>
<table>
<thead>
<tr><th>Name</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>viewModel</td><td>The View Model name as defined in <strong>config.app.js</strong></td></tr>
<tr><td>aggregateIds</td><td>The comma-separated list of Aggregate IDs to include into the View Model. Use <code>*</code> to include all Aggregates</td></tr>
</tbody>
</table>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-4-frontend-display-view-model-data-in-the-browser"></a><a href="#lesson-4-frontend-display-view-model-data-in-the-browser" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 4</strong> - Frontend - Display View Model Data in the Browser</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-4">[Get the Code for This Lesson]</a></p>
<p>In the previous lesson, you modified your application so that it can answer queries. However, at this moment, your application does not provide a <a href="/resolve/docs/frontend">frontent</a> that would present this data to an end-user. In this lesson, you will learn how to create a React frontend to display your reSolve application's data.</p>
<p>To keep the example code simple, in this lesson you will only display items of a single shopping list. Later on, you will add support for multiple shopping lists and provide the required means of navigation between lists.</p>
<p>This tutorial sticks to React + Redux as the default choice for building a frontend for a reSolve application. Both React and Redux work well in conjunction with reSolve's infrastructure. ReSolve comes with the client <strong>resolve-redux</strong> library that provides HOCs allowing you to easily connect your React components to the backend.</p>
<p>Note that, if required, you can use the <a href="/resolve/docs/curl">standard HTTP API</a> to communicate with a reSolve backend and implement the frontend using any client-side technology.</p>
<h3><a class="anchor" aria-hidden="true" id="implement-a-react-frontend"></a><a href="#implement-a-react-frontend" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement a React Frontend</h3>
<p>Create a <strong>ShoppingList.js</strong> file in the client application's containers folder. In this file, implement a component that displays a list of values obtained from the <strong><a href="/resolve/docs/frontend#obtain-view-model-data">data</a></strong> prop:</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-comment">// The example code uses components from the react-bootstrap library to keep the markup compact.</span>
<span class="hljs-keyword">import</span> { ListGroup, ListGroupItem, Checkbox } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShoppingList</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">PureComponent</span> </span>{
  render() {
    <span class="hljs-keyword">const</span> list = <span class="hljs-keyword">this</span>.props.data.list
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ListGroup</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">maxWidth:</span> '<span class="hljs-attr">500px</span>', <span class="hljs-attr">margin:</span> '<span class="hljs-attr">auto</span>' }}&gt;</span>
        {list.map(todo =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ListGroupItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Checkbox</span> <span class="hljs-attr">inline</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">Checkbox</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroupItem</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ListGroup</span>&gt;</span></span>
    )
  }
}
</code></pre>
<!-- prettier-ignore-end -->
<p>Now you can use the <strong>resolve-redux</strong> library's <strong>connectViewModel</strong> HOC to bind your component to the <strong>ShoppingList</strong> view model implemented earlier:</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToOptions = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">viewModelName</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">aggregateIds</span>: [<span class="hljs-string">'shopping-list-1'</span>]
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connectViewModel(mapStateToOptions)(ShoppingList)
</code></pre>
<!-- prettier-ignore-end -->
<p>The connectViewModel HOC binds the original component to a reSolve View Model based on options provided by the <strong>mapStateToOptions</strong> function. The <strong>data</strong> prop that you used in your component's implementation is injected by this HOC and contains the View Model's response object. It is the same object that saw when you manually performed a data query using the HTTP API in the lesson 3:</p>
<pre><code class="hljs css language-js">{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-1"</span>,
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>,
  <span class="hljs-string">"list"</span>: [
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"1"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Milk"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"2"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Eggs"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"3"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Canned beans"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    },
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"4"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"Paper towels"</span>,
      <span class="hljs-string">"checked"</span>: <span class="hljs-literal">false</span>
    }
  ]
}
</code></pre>
<p>Place the implemented shopping list within the application's root component:</p>
<p><strong>client/containers/App.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> App = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    ...
    <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingList</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
)
</code></pre>
<p>Run your application to see the result:
<img src="/resolve/docs/assets/tutorial/lesson4_result.png" alt="result"></p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-5-frontend-enable-data-editing"></a><a href="#lesson-5-frontend-enable-data-editing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 5</strong> - Frontend - Enable Data Editing</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-5">[Get the Code for This Lesson]</a></p>
<h3><a class="anchor" aria-hidden="true" id="modify-backend-functionality"></a><a href="#modify-backend-functionality" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify Backend Functionality</h3>
<p>Your application already implements logic required to add new list items. Apply the following modifications to the server code to also support item checking:</p>
<ol>
<li>Add a new event type that signals about the item checkbox being toggled.</li>
</ol>
<p><strong>common/eventTypes.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_TOGGLED = <span class="hljs-string">"SHOPPING_ITEM_TOGGLED"</span>;
</code></pre>
<!-- prettier-ignore-end -->
<ol start="2">
<li>Add a command handler that produces the added event in response to the <strong>toggleShoppingItem</strong> command.</li>
</ol>
<p><strong>common/aggregates/shopping_list.commands.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">  toggleShoppingItem: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!state || !state.createdAt) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`shopping list does not exist`</span>)
    }
    <span class="hljs-keyword">if</span> (!id) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'id is required'</span>)
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_ITEM_TOGGLED,
      <span class="hljs-attr">payload</span>: { id }
    }
  }
</code></pre>
<!-- prettier-ignore-end -->
<p>The event payload contains the toggled item's identifier.</p>
<ol start="4">
<li>Modify the <strong>ShoppingList</strong> View Model projection to apply <strong>SHOPPING_ITEM_TOGGLED</strong> events to the data sample.</li>
</ol>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">  [SHOPPING_ITEM_TOGGLED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">list</span>: state.list.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span>
      item.id === id
        ? {
            ...item,
            <span class="hljs-attr">checked</span>: !item.checked
          }
        : item
    )
  })
</code></pre>
<!-- prettier-ignore-end -->
<h3><a class="anchor" aria-hidden="true" id="implement-data-editing-ui"></a><a href="#implement-data-editing-ui" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement Data Editing UI</h3>
<p>In the previous lesson, you connected your ShoppingList to a reSolve View Model. Because of this, the connected component's props already include an array of Redux action creators used to dispatch Redux actions on the client and send the corresponding commands to the reSolve application on the server. To make use of these action creators to implement editing in your application, update the ShoppingList component's View Model binding code as shown below:</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapDispatchToProps = <span class="hljs-function">(<span class="hljs-params">dispatch, { aggregateActions }</span>) =&gt;</span>
  bindActionCreators(
    {
      ...aggregateActions
    },
    dispatch
  )

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connectViewModel(mapStateToOptions)(
  connect(
    <span class="hljs-literal">null</span>,
    mapDispatchToProps
  )(ShoppingList)
)
</code></pre>
<!-- prettier-ignore-end -->
<p>In this code, the component is first connected to a <strong>Redux</strong> state using the <strong>connect</strong> HOC from the <strong>react-redux</strong> library. Then, the component is connected to a reSolve View Model as it was in the previous lesson. The <strong>connect</strong> function is called with the specified <strong>mapDispatchToProps</strong> function. This function takes reSolve aggregate actions from the components payload and wraps them into a <strong>dispatch</strong> function call using the the <strong>bindActionCreators</strong> function.</p>
<p>Now the ShoppingList component's props include the <strong>toggleShoppingItem</strong> function.</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<pre><code class="hljs css language-js">render() {
  <span class="hljs-keyword">const</span> toggleShoppingItem = <span class="hljs-keyword">this</span>.props.toggleShoppingItem;
  ...
</code></pre>
<p>You can use this function to handle item checking on the client and send the <strong>toggleShoppingItem</strong> command to the server along with the required data in the payload.</p>
<p>In the code below, the <strong>toggleShoppingItem</strong> function is used to handle checkbox click events.</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">              &lt;Checkbox
                inline
                checked={todo.checked}
                onChange={toggleShoppingItem.bind(null, 'shopping-list-1', {
                  id: todo.id
                })}
              &gt;
                {todo.text}
              &lt;/Checkbox&gt;
</code></pre>
<!-- prettier-ignore-end -->
<p>In the same way, you can use the <strong>createShoppingItem</strong> function to add new shopping list items. The UI markup is shown below:</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">        &lt;ControlLabel&gt;Item name&lt;/ControlLabel&gt;
        &lt;Row&gt;
          &lt;Col md={8}&gt;
            &lt;FormControl
              className="example-form-control"
              type="text"
              value={this.state.itemText}
              onChange={this.updateItemText}
              onKeyPress={this.onItemTextPressEnter}
            /&gt;
          &lt;/Col&gt;
          &lt;Col md={4}&gt;
            &lt;Button
              className="example-button"
              bsStyle="success"
              onClick={this.createShoppingItem}
            &gt;
              Add Item
            &lt;/Button&gt;
          &lt;/Col&gt;
        &lt;/Row&gt;
</code></pre>
<!-- prettier-ignore-end -->
<p>This markup uses the following methods to handle UI interaction.</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<pre><code class="hljs css language-js">createShoppingItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">this</span>.props.createShoppingItem(<span class="hljs-string">'shopping-list-1'</span>, {
    <span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>.state.itemText,
    <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now().toString()
  })

  <span class="hljs-keyword">this</span>.setState({
    <span class="hljs-attr">itemText</span>: <span class="hljs-string">''</span>
  })
}

updateItemText = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
  <span class="hljs-keyword">this</span>.setState({
    <span class="hljs-attr">itemText</span>: event.target.value
  })
}

onItemTextPressEnter = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (event.charCode === <span class="hljs-number">13</span>) {
    event.preventDefault()
    <span class="hljs-keyword">this</span>.createShoppingItem()
  }
}
</code></pre>
<p>After these steps, your application's client UI should look as shown below.</p>
<p><img src="/resolve/docs/assets/tutorial/lesson5_result.png" alt="result"></p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-6-frontend-support-multiple-shopping-lists"></a><a href="#lesson-6-frontend-support-multiple-shopping-lists" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 6</strong> - Frontend - Support Multiple Shopping Lists</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-6">[Get the Code for This Lesson]</a></p>
<p>In the previous two lessons, you have been implementing the client-side UI for viewing and editing items in a shopping list. However, you may have noticed that your application's functionality is incomplete: it is possible use HTTP API to create multiple shopping lists, but the client UI only allows viewing and editing only one specific list, namely <strong>shopping-list-1</strong>:</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToOptions = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">viewModelName</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">aggregateIds</span>: [<span class="hljs-string">'shopping-list-1'</span>]
  }
}
</code></pre>
<p>In this lesson, you will enhance your application's functionality with the capability to create multiple shopping lists, navigate between these lists and add items to them using the client UI.</p>
<h3><a class="anchor" aria-hidden="true" id="implement-a-shopping-lists-read-model"></a><a href="#implement-a-shopping-lists-read-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement a Shopping Lists Read Model</h3>
<p>In the <a href="#lesson-3-read-side-create-a-view-model-to-query-list-items">Lesson 3</a>, you have implemented a View Model used to obtain information about shopping lists with the specified aggregate ID's. Although it is possible to use the same approach for obtaining the list of all available shopping lists, there is a strong reason not to do so.</p>
<p>Consider a situation, in which your application has been running in a production environment for a long time and a large number of shopping lists has been created. If you used a View Model to answer queries, a resulting data sample would be generated on the fly for every requests using events from the beginning of the history, which will result in a huge performance overhead on <em>each request</em>. Note that it is not a problem when you use a View Model to obtain a single list's items as the item count is always considerably small.</p>
<p>To overcome this issue, implement a ShoppingLists <strong><a href="/resolve/docs/read-side#read-models">Read Model</a></strong>. This Read Model will gradually accumulate its state based on incoming events and store this state in the Read Model Storage. This part of the functionality is implemented by the Red Model <strong><a href="/resolve/docs/read-side">projection</a></strong>:</p>
<p><strong>common/read-models/shopping_lists.projection.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { SHOPPING_LIST_CREATED } <span class="hljs-keyword">from</span> <span class="hljs-string">'../eventTypes'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">Init</span>: <span class="hljs-keyword">async</span> store =&gt; {
    <span class="hljs-keyword">await</span> store.defineTable(<span class="hljs-string">'ShoppingLists'</span>, {
      <span class="hljs-attr">indexes</span>: {
        <span class="hljs-attr">id</span>: <span class="hljs-string">'string'</span>
      },
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">'createdAt'</span>, <span class="hljs-string">'name'</span>]
    })
  },

  [SHOPPING_LIST_CREATED]: <span class="hljs-keyword">async</span> (
    store,
    { aggregateId, timestamp, <span class="hljs-attr">payload</span>: { name } }
  ) =&gt; {
    <span class="hljs-keyword">const</span> shoppingList = {
      <span class="hljs-attr">id</span>: aggregateId,
      name,
      <span class="hljs-attr">createdAt</span>: timestamp
    }

    <span class="hljs-keyword">await</span> store.insert(<span class="hljs-string">'ShoppingLists'</span>, shoppingList)
  }
}
</code></pre>
<!-- prettier-ignore-end -->
<p>You also need to implement <strong><a href="/resolve/docs/read-side#resolvers">resolver functions</a></strong> that will answer queries using the accumulated data.</p>
<p><strong>common/read-models/shopping_lists.resolvers.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">all</span>: <span class="hljs-keyword">async</span> store =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> store.find(<span class="hljs-string">'ShoppingLists'</span>, {}, <span class="hljs-literal">null</span>, { <span class="hljs-attr">createdAt</span>: <span class="hljs-number">1</span> })
  }
}
</code></pre>
<!-- prettier-ignore-end -->
<p>In this example, the <strong>all</strong> resolver function is used to obtain all available shopping lists.</p>
<p>Register the created Read Model in the application's configuration file:</p>
<p><strong>config.app.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js">  readModels: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'ShoppingLists'</span>,
      <span class="hljs-attr">projection</span>: <span class="hljs-string">'common/read-models/shopping_lists.projection.js'</span>,
      <span class="hljs-attr">resolvers</span>: <span class="hljs-string">'common/read-models/shopping_lists.resolvers.js'</span>
    }
  ],
</code></pre>
<!-- prettier-ignore-end -->
<p>Note that regular Read Models are not reactive like View Models are. This results in several side effects, that will be discussed in greater detail later in this lesson.</p>
<h3><a class="anchor" aria-hidden="true" id="query-a-read-model-through-http-api"></a><a href="#query-a-read-model-through-http-api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query a Read Model Through HTTP API</h3>
<p>You can test the ShoppingLists Read Model's functionality using the standard HTTP API:</p>
<pre><code class="hljs css language-sh">$ curl -X POST \
-H <span class="hljs-string">"Content-Type: application/json"</span> \
-d <span class="hljs-string">"{}"</span> \
<span class="hljs-string">"http://localhost:3000/api/query/ShoppingLists/all"</span>


% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   186  100   184  100     2    844      9 --:--:-- --:--:-- --:--:--   906[
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-1"</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 1"</span>,
    <span class="hljs-string">"createdAt"</span>: 1543325125945
  },
  {
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"shopping-list-2"</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"List 2"</span>,
    <span class="hljs-string">"createdAt"</span>: 1543325129138
  }
]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="implement-client-ui"></a><a href="#implement-client-ui" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implement Client UI</h3>
<p>Now you can implement the UI to display all available shopping list an provide and create new shopping lists.</p>
<p><strong>client/containers/MyLists.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyLists</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">PureComponent</span> </span>{
  render() {
    <span class="hljs-keyword">const</span> { lists, createShoppingList } = <span class="hljs-keyword">this</span>.props
    <span class="hljs-keyword">return</span> (
      &lt;div style={{ maxWidth: '500px', margin: 'auto' }}&gt;
        &lt;ShoppingLists lists={lists} /&gt;
        &lt;ShoppingListCreator
          lists={lists}
          createShoppingList={createShoppingList}
        /&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre>
<!-- prettier-ignore-end -->
<p>See the <strong>shoppingLists</strong> and <strong>shoppingListsCreator</strong> files to see the details of these components' implementation.</p>
<p>The implemented container component is bound to the ShoppingLists Read Model as shown below:</p>
<p><strong>client/containers/MyLists.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToOptions = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
  <span class="hljs-attr">readModelName</span>: <span class="hljs-string">'ShoppingLists'</span>,
  <span class="hljs-attr">resolverName</span>: <span class="hljs-string">'all'</span>,
  <span class="hljs-attr">resolverArgs</span>: {}
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> ({
  <span class="hljs-attr">lists</span>: ownProps.data
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapDispatchToProps = <span class="hljs-function">(<span class="hljs-params">dispatch, { aggregateActions }</span>) =&gt;</span>
  bindActionCreators(aggregateActions, dispatch)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connectReadModel(mapStateToOptions)(
  connect(
    mapStateToProps,
    mapDispatchToProps
  )(MyLists)
)
</code></pre>
<p>Now that your application has two main views, you need to provide means of navigation between them. To achieve this goal, you need to configure the react router.</p>
<p><strong>client/routes.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/App'</span>
<span class="hljs-keyword">import</span> ShoppingList <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/ShoppingList'</span>
<span class="hljs-keyword">import</span> MyLists <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/MyLists'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
  {
    <span class="hljs-attr">component</span>: App,
    <span class="hljs-attr">routes</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
        <span class="hljs-attr">component</span>: MyLists,
        <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span>
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/:id'</span>,
        <span class="hljs-attr">component</span>: ShoppingList
      }
    ]
  }
]
</code></pre>
<!-- prettier-ignore-end -->
<p>Next, modify the <strong>App</strong> component to use the router.</p>
<p><strong>client/containers/App.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'./Header.js'</span>
<span class="hljs-keyword">import</span> ShoppingList <span class="hljs-keyword">from</span> <span class="hljs-string">'./ShoppingList'</span>

<span class="hljs-keyword">const</span> App = ({
  children,
  <span class="hljs-attr">match</span>: {
    <span class="hljs-attr">params</span>: { id }
  }
}) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Header</span>
      <span class="hljs-attr">title</span>=<span class="hljs-string">"reSolve Shopping List"</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">"Shopping List"</span>
      <span class="hljs-attr">favicon</span>=<span class="hljs-string">"/favicon.ico"</span>
      <span class="hljs-attr">css</span>=<span class="hljs-string">{[</span>'/<span class="hljs-attr">bootstrap.min.css</span>']}
    /&gt;</span>
    {children}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
)

export default App
</span></code></pre>
<!-- prettier-ignore-end -->
<p>Also, modify the <strong>ShoppingList</strong> component so it obtains the list aggregate ID from the <strong>:id</strong> route parameter and displays proper items.</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToOptions = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> aggregateId = ownProps.match.params.id

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">viewModelName</span>: <span class="hljs-string">'ShoppingList'</span>,
    <span class="hljs-attr">aggregateIds</span>: [aggregateId]
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> aggregateId = ownProps.match.params.id

  <span class="hljs-keyword">return</span> {
    aggregateId
  }
}
</code></pre>
<p>For now, binding a component to a reSolve Read Model looks similar to how you bound the ShoppingList component to a View Model in the <a href="#lesson-4-frontend-display-view-model-data-in-the-browser">Lesson 4</a>. Run, your application and try adding a new shopping list using the implemented UI.</p>
<p>You should have noticed that although you application correctly sends commands to the backend, the client UI does not reflect the change in the application state. A newly created shopping list only appears after you refresh the page. This is an expected behavior because Read Models are not reactive by default. This means that components connected to Read Models do not automatically synchronize their Redux state with the Read Model state on the server.</p>
<p>You can overcome this limitation by introducing optimistic UI updates as the next section describes.</p>
<h3><a class="anchor" aria-hidden="true" id="support-optimistic-ui-updates"></a><a href="#support-optimistic-ui-updates" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Support Optimistic UI Updates</h3>
<p>With the optimistic UI updating approach, a component applies model changes to the client Redux state before sending them to the server using an aggregate command. Follow the steps below to provide such functionality.</p>
<p>First, define Redux actions that will perform updates:</p>
<p><strong>client/actions/optimistic_actions.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> OPTIMISTIC_CREATE_SHOPPING_LIST = <span class="hljs-string">'OPTIMISTIC_CREATE_SHOPPING_LIST'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> OPTIMISTIC_SYNC = <span class="hljs-string">'OPTIMISTIC_SYNC'</span>
</code></pre>
<!-- prettier-ignore-end -->
<p>Implement an optimistic reducer function that responds to these commands to update the corresponding slice of the Redux state:</p>
<p><strong>client/reducers/optimistic_shopping_lists.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { LOCATION_CHANGE } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-redux'</span>
<span class="hljs-keyword">import</span> {
  OPTIMISTIC_CREATE_SHOPPING_LIST,
  OPTIMISTIC_SYNC
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../actions/optimistic_actions'</span>

<span class="hljs-keyword">const</span> optimistic_shopping_lists = <span class="hljs-function">(<span class="hljs-params">state = [], action</span>) =&gt;</span> {
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> LOCATION_CHANGE: {
      <span class="hljs-keyword">return</span> []
    }
    <span class="hljs-keyword">case</span> OPTIMISTIC_CREATE_SHOPPING_LIST: {
      <span class="hljs-keyword">return</span> [
        ...state,
        {
          <span class="hljs-attr">id</span>: action.payload.id,
          <span class="hljs-attr">name</span>: action.payload.name
        }
      ]
    }
    <span class="hljs-keyword">case</span> OPTIMISTIC_SYNC: {
      <span class="hljs-keyword">return</span> action.payload.originalLists
    }
    <span class="hljs-keyword">default</span>: {
      <span class="hljs-keyword">return</span> state
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> optimistic_shopping_lists
</code></pre>
<!-- prettier-ignore-end -->
<p>Provide a middleware that intercepts the service actions used for communication between between Redux and reSolve:</p>
<p><strong>client/reducers/optimistic_shopping_lists_middleware.js:</strong></p>
<!-- prettier-ignore-start -->
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { actionTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">'resolve-redux'</span>

<span class="hljs-keyword">import</span> {
  OPTIMISTIC_CREATE_SHOPPING_LIST,
  OPTIMISTIC_SYNC
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../actions/optimistic_actions'</span>

<span class="hljs-keyword">const</span> { SEND_COMMAND_SUCCESS, LOAD_READMODEL_STATE_SUCCESS } = actionTypes

<span class="hljs-keyword">const</span> optimistic_shopping_lists_middleware = <span class="hljs-function"><span class="hljs-params">store</span> =&gt;</span> next =&gt; <span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (
    action.type === SEND_COMMAND_SUCCESS &amp;&amp;
    action.commandType === <span class="hljs-string">'createShoppingList'</span>
  ) {
    store.dispatch({
      <span class="hljs-attr">type</span>: OPTIMISTIC_CREATE_SHOPPING_LIST,
      <span class="hljs-attr">payload</span>: {
        <span class="hljs-attr">id</span>: action.aggregateId,
        <span class="hljs-attr">name</span>: action.payload.name
      }
    })
  }
  <span class="hljs-keyword">if</span> (action.type === LOAD_READMODEL_STATE_SUCCESS) {
    store.dispatch({
      <span class="hljs-attr">type</span>: OPTIMISTIC_SYNC,
      <span class="hljs-attr">payload</span>: {
        <span class="hljs-attr">originalLists</span>: action.result
      }
    })
  }

  next(action)
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> optimistic_shopping_lists_middleware
</code></pre>
<!-- prettier-ignore-end -->
<p>Modify the <strong>mapStateToProps</strong> function implementation for the MyLists component so that component props are bound to the implemented slice of the Redux state:</p>
<pre><code class="hljs css language-jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> ({
  <span class="hljs-attr">lists</span>: state.optimisticShoppingLists || []
})
</code></pre>
<p>Now, if you run your application and create a new shopping list, the created shopping list will be displayed immediately.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="lesson-7-functionality-enhancements"></a><a href="#lesson-7-functionality-enhancements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Lesson 7</strong> - Functionality Enhancements</h2>
<p><a href="https://github.com/reimagined/resolve/tree/master/examples/shopping-list-tutorial/lesson-7">[Get the Code for This Lesson]</a></p>
<p>In this lesson, you will provide miscellaneous functionality enhancements to your Shopping List application in order to support the full set of data editing operations. These steps are not essential, but they will help you further deepen your understanding of the reSolve framework's fundamentals.</p>
<h3><a class="anchor" aria-hidden="true" id="modify-the-write-side"></a><a href="#modify-the-write-side" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the Write Side</h3>
<p>Define additional events to provide the missing functionality.</p>
<p><strong>common/event_types.js:</strong></p>
<pre><code class="hljs css language-js">...
export <span class="hljs-keyword">const</span> SHOPPING_LIST_RENAMED = <span class="hljs-string">'SHOPPING_LIST_RENAMED'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_LIST_REMOVED = <span class="hljs-string">'SHOPPING_LIST_REMOVED'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SHOPPING_ITEM_REMOVED = <span class="hljs-string">'SHOPPING_ITEM_REMOVED'</span>
</code></pre>
<p>Modify the aggregate projection to account for shopping list deletion.</p>
<p><strong>common/aggregates/shopping_list.projection.js:</strong></p>
<pre><code class="hljs css language-js">[SHOPPING_LIST_REMOVED]: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({})
</code></pre>
<p>Define command handlers to provide the data editing functionality.</p>
<p><strong>common/aggregates/shopping_list.commands.js:</strong></p>
<pre><code class="hljs css language-js">...

  renameShoppingList: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_LIST_RENAMED,
      <span class="hljs-attr">payload</span>: { name }
    }
  },

  <span class="hljs-attr">removeShoppingList</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_LIST_REMOVED
    }
  },

  <span class="hljs-attr">removeShoppingItem</span>: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: SHOPPING_ITEM_REMOVED,
      <span class="hljs-attr">payload</span>: { id }
    }
  }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="modify-the-read-side"></a><a href="#modify-the-read-side" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the Read Side</h3>
<p>Modify the ShoppingList View Model projection to account for the new functionality.</p>
<p><strong>common/view-models/shopping_list.projection.js:</strong></p>
<pre><code class="hljs css language-js">...

  [SHOPPING_LIST_RENAMED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { name } }</span>) =&gt;</span> ({
    ...state,
    name
  }),

  [SHOPPING_LIST_REMOVED]: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">removed</span>: <span class="hljs-literal">true</span>
  }),

  [SHOPPING_ITEM_REMOVED]: <span class="hljs-function">(<span class="hljs-params">state, { payload: { id } }</span>) =&gt;</span> ({
    ...state,
    <span class="hljs-attr">list</span>: state.list.filter(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.id !== id)
  })
</code></pre>
<p>Modify the ShoppingLists Read Model projection.</p>
<p><strong>common/read-models/shopping_lists.projection.js:</strong></p>
<pre><code class="hljs css language-js">...

  [SHOPPING_LIST_REMOVED]: <span class="hljs-keyword">async</span> (store, { aggregateId }) =&gt; {
    <span class="hljs-keyword">await</span> store.delete(<span class="hljs-string">'ShoppingLists'</span>, { <span class="hljs-attr">id</span>: aggregateId })
  },

  [SHOPPING_LIST_RENAMED]: <span class="hljs-keyword">async</span> (
    store,
    { aggregateId, <span class="hljs-attr">payload</span>: { name } }
  ) =&gt; {
    <span class="hljs-keyword">await</span> store.update(<span class="hljs-string">'ShoppingLists'</span>, { <span class="hljs-attr">id</span>: aggregateId }, { <span class="hljs-attr">$set</span>: { name } })
  }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="modify-the-frontend"></a><a href="#modify-the-frontend" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify the Frontend</h3>
<h4><a class="anchor" aria-hidden="true" id="add-static-content"></a><a href="#add-static-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add Static Content</h4>
<p>Add the required static content to the application's <strong>static</strong> folder. The example application uses the following static files:</p>
<ul>
<li>The <strong>Styles.css</strong> file - Contains custom styles used by the application's client components.</li>
<li>The <strong>fontawesome.min.css</strong> file an the <strong>webfonts</strong> folder - The standard Font Awesome distribution.</li>
<li>The <strong>close-button.png</strong> image - An icon displayed by the button used to remove shopping list items.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="update-components"></a><a href="#update-components" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update Components</h4>
<p>Modify the ShoppingLists component to support shopping list deletion.</p>
<p><strong>client/components/ShoppingLists.js:</strong></p>
<pre><code class="hljs css language-js">&lt;th className="example-table-action"&gt;Action&lt;/th&gt;
...

&lt;td className="example-table-action"&gt;
  &lt;Button
    onClick={() =&gt; {
      this.props.removeShoppingList(id)
    }}
  &gt;
    &lt;i className="far fa-trash-alt" /&gt;
  &lt;/Button&gt;
&lt;/td&gt;

</code></pre>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> { lists, createShoppingList, removeShoppingList } = <span class="hljs-keyword">this</span>.props
...
&lt;ShoppingLists lists={lists} removeShoppingList={removeShoppingList} /&gt;
</code></pre>
<p>Modify the ShoppingList component to support shopping list renaming.</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<pre><code class="hljs css language-js">state = {
  <span class="hljs-attr">shoppingListName</span>: <span class="hljs-keyword">this</span>.props.data &amp;&amp; <span class="hljs-keyword">this</span>.props.data.name
  ...
}

renameShoppingList = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">this</span>.props.renameShoppingList(<span class="hljs-keyword">this</span>.props.aggregateId, {
    <span class="hljs-attr">name</span>: <span class="hljs-keyword">this</span>.state.shoppingListName
  })
}

onShoppingListNamePressEnter = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (event.charCode === <span class="hljs-number">13</span>) {
    event.preventDefault()
    <span class="hljs-keyword">this</span>.renameShoppingList()
  }
}

updateShoppingListName = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
  <span class="hljs-keyword">this</span>.setState({
    <span class="hljs-attr">shoppingListName</span>: event.target.value
  })
}
...

&lt;FormControl
  type=<span class="hljs-string">"text"</span>
  value={<span class="hljs-keyword">this</span>.state.shoppingListName}
  onChange={<span class="hljs-keyword">this</span>.updateShoppingListName}
  onKeyPress={<span class="hljs-keyword">this</span>.onShoppingListNamePressEnter}
  onBlur={<span class="hljs-keyword">this</span>.renameShoppingList}
/&gt;
</code></pre>
<p>Add list item deletion functionality.</p>
<p><strong>client/containers/ShoppingList.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> {
  ...
  removeShoppingItem
} = <span class="hljs-keyword">this</span>.props

&lt;Image
  className=<span class="hljs-string">"example-close-button"</span>
  src=<span class="hljs-string">"/close-button.png"</span>
  onClick={removeShoppingItem.bind(<span class="hljs-literal">null</span>, aggregateId, {
    <span class="hljs-attr">id</span>: todo.id
  })}
/&gt;
</code></pre>
<p>The <strong>Image</strong> component is implemented as follows.</p>
<p><strong>client/containers/Image.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { Image <span class="hljs-keyword">as</span> BootstrapImage } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-bootstrap'</span>
<span class="hljs-keyword">import</span> { connectStaticBasedUrls } <span class="hljs-keyword">from</span> <span class="hljs-string">'resolve-redux'</span>

<span class="hljs-keyword">const</span> Image = connectStaticBasedUrls([<span class="hljs-string">'src'</span>])(BootstrapImage)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Image
</code></pre>
<p>####Link Stylesheets:</p>
<p>The code sample below demonstrates how to link stylesheets to your application.</p>
<p><strong>client/containers/Header.js:</strong></p>
<pre><code class="hljs css language-js">&lt;Helmet&gt;
  {css.map(<span class="hljs-function">(<span class="hljs-params">href, index</span>) =&gt;</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{href}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> /&gt;</span>
  ))}
  ...
<span class="hljs-tag">&lt;/<span class="hljs-name">Helmet</span>&gt;</span></span>
...
export <span class="hljs-keyword">default</span> connectStaticBasedUrls([<span class="hljs-string">'css'</span>, <span class="hljs-string">'favicon'</span>])(Header)
</code></pre>
<p><strong>client/containers/App.js:</strong></p>
<pre><code class="hljs css language-js">&lt;Header
  css={[<span class="hljs-string">'/fontawesome.min.css'</span>, <span class="hljs-string">'/style.css'</span>, ...]}
  ...
/&gt;
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="update-the-optimistic-update-code"></a><a href="#update-the-optimistic-update-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update the Optimistic Update Code</h4>
<p>Modify the code performing optimistic UI updates to support shopping list deletion.</p>
<p><strong>client/actions/optimistic_actions.js:</strong></p>
<pre><code class="hljs css language-js">...
export <span class="hljs-keyword">const</span> OPTIMISTIC_REMOVE_SHOPPING_LIST = <span class="hljs-string">'OPTIMISTIC_REMOVE_SHOPPING_LIST'</span>
</code></pre>
<p><strong>client/reducers/optimistic_shopping_lists.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { LOCATION_CHANGE } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-redux'</span>
...

  switch (action.type) {
    <span class="hljs-keyword">case</span> LOCATION_CHANGE: {
      <span class="hljs-keyword">return</span> []
    }
    <span class="hljs-keyword">case</span> OPTIMISTIC_REMOVE_SHOPPING_LIST: {
      <span class="hljs-keyword">return</span> state.filter(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-keyword">return</span> item.id !== action.payload.id
      })
    }
    ...
  }
</code></pre>
<p><strong>client/middlewares/optimistic_shopping_lists_middleware.js:</strong></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> optimistic_shopping_lists_middleware = <span class="hljs-function"><span class="hljs-params">store</span> =&gt;</span> next =&gt; <span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (
    action.type === SEND_COMMAND_SUCCESS &amp;&amp;
    action.commandType === <span class="hljs-string">'removeShoppingList'</span>
  ) {
    store.dispatch({
      <span class="hljs-attr">type</span>: OPTIMISTIC_REMOVE_SHOPPING_LIST,
      <span class="hljs-attr">payload</span>: {
        <span class="hljs-attr">id</span>: action.aggregateId
      }
    })
  }

  next(action)
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/resolve/docs/introduction"><span class="arrow-prev">← </span><span>Introduction</span></a><a class="docs-next button" href="/resolve/docs/app-structure"><span class="function-name-prevnext">reSolve App Structure</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#lesson-1-create-a-new-resolve-application"><strong>Lesson 1</strong> - Create a New reSolve Application</a></li><li><a href="#lesson-2-write-side-add-a-list-item"><strong>Lesson 2</strong> - Write side - Add a List Item</a><ul class="toc-headings"><li><a href="#creating-an-aggregate">Creating an Aggregate</a></li><li><a href="#sending-commands-to-an-aggregate">Sending Commands to an Aggregate</a></li><li><a href="#performing-validation">Performing Validation</a></li></ul></li><li><a href="#lesson-3-read-side-create-a-view-model-to-query-list-items"><strong>Lesson 3</strong> - Read side - Create a View Model to Query List Items</a><ul class="toc-headings"><li><a href="#implement-a-view-model">Implement a View Model</a></li><li><a href="#query-a-view-model-via-http-api">Query a View Model via HTTP API</a></li></ul></li><li><a href="#lesson-4-frontend-display-view-model-data-in-the-browser"><strong>Lesson 4</strong> - Frontend - Display View Model Data in the Browser</a><ul class="toc-headings"><li><a href="#implement-a-react-frontend">Implement a React Frontend</a></li></ul></li><li><a href="#lesson-5-frontend-enable-data-editing"><strong>Lesson 5</strong> - Frontend - Enable Data Editing</a><ul class="toc-headings"><li><a href="#modify-backend-functionality">Modify Backend Functionality</a></li><li><a href="#implement-data-editing-ui">Implement Data Editing UI</a></li></ul></li><li><a href="#lesson-6-frontend-support-multiple-shopping-lists"><strong>Lesson 6</strong> - Frontend - Support Multiple Shopping Lists</a><ul class="toc-headings"><li><a href="#implement-a-shopping-lists-read-model">Implement a Shopping Lists Read Model</a></li><li><a href="#query-a-read-model-through-http-api">Query a Read Model Through HTTP API</a></li><li><a href="#implement-client-ui">Implement Client UI</a></li><li><a href="#support-optimistic-ui-updates">Support Optimistic UI Updates</a></li></ul></li><li><a href="#lesson-7-functionality-enhancements"><strong>Lesson 7</strong> - Functionality Enhancements</a><ul class="toc-headings"><li><a href="#modify-the-write-side">Modify the Write Side</a></li><li><a href="#modify-the-read-side">Modify the Read Side</a></li><li><a href="#modify-the-frontend">Modify the Frontend</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/resolve/" class="nav-home"><img src="/resolve/img/resolve.svg" alt="reSolve" width="66" height="58"/></a><div><h5>Docs</h5><a href="/resolve/docs/">Documentation Index</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/resolvejs" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/resolvejs" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.facebook.com/resolvejs/" target="_blank" rel="noreferrer noopener">Facebook</a></div><div><h5>More</h5><a href="https://github.com/reimagined/resolve">GitHub</a><a class="github-button" href="https://github.com/reimagined/resolve" data-icon="octicon-star" data-count-href="/reimagined/resolve/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 reimagined</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2acd75b7a94d568aa418a4f02bd811cc',
                indexName: 'reimagined_resolve',
                inputSelector: '#search_input_react'
              });
            </script></body></html>